{% comment %}
This include handles two cases:
1. Home page: called with directory parameter to show speakers from upcoming session
2. Session pages: called without parameters, uses page.speakers (processed by session generator)
{% endcomment %}

{% if include.directory %}
  {% comment %}Home page case: extract speakers from specified directory{% endcomment %}
  {% assign speakers_found = '' | split: '' %}
  {% assign unique_speakers = '' | split: '' %}

  {% for agenda_item in site.data.[include.directory].agenda %}
    {% if agenda_item.speakers %}
      {% for speaker in agenda_item.speakers %}
        {% unless speakers_found contains speaker.name %}
          {% assign speakers_found = speakers_found | push: speaker.name %}
          {% assign unique_speakers = unique_speakers | push: speaker %}
        {% endunless %}
      {% endfor %}
    {% endif %}
  {% endfor %}

  {% include speakers_grid.html speakers=unique_speakers title="Les Intervenants" data_directory=include.directory %}

{% elsif page.speakers and page.speakers.size > 0 %}
  {% comment %}Session page case: use pre-processed speakers from session generator{% endcomment %}
  {% include speakers_grid.html speakers=page.speakers title="Les Intervenants" data_directory=page.data_directory %}
{% endif %}
